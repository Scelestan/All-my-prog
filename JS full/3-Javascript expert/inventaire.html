<!DOCTYPE html>
<html>
   
   <head>
      <meta name="viewport"
         content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
      <title>Create game with PIXIJS
      </title>
      <style>
         html,
         body,
         canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
         }
         
         #renderCanvas {
            width: 22%;
            height: 22%;
            top: 39%;
            left: 37%;
            touch-action: none;
         }
         
      </style>
      <script
         src="https://pixijs.download/release/pixi.min.js">
      </script>
      <script>
         var ad = [];
         var prog = function (A, x, y,
            t1, l1) {
            var boula2;
            var WII = self
            .innerWidth;
            var zm = false;
            var EH = (((self
                     .innerHeight *
                     getZoom()) /
                  (self
                     .innerHeight)
                  ) / (
            getZoom()) * y);
            var EW = (self
               .innerWidth *
               getZoom()) / (self
               .innerWidth) / (
               getZoom() * x);
            var c1113;
            ad.push([
                                                A
               ]);
            var Ce = "";
            var ih;
            var iw;
            var X11 = 0;
            var X22 = 0;
            var W11 = 0;
            var W22 = 0;
            var VH = y;
            var VW = x;
            if (!l1) {
               var ET = 0;
               var EL = 0;
               var VT = 0;
               var VL = 0;
            }
            else {
               var ET = t1;
               var EL = l1;
               var VT = t1;
               var VL = l1;
            }
            var LW;
            var LH;
            var Ra = 1;
            var tbd = "";
            var ekt3 = [];
            var ekt22 = [];
            var VI = A;
            var IC = A;
            
            function datacollei(
            XXff) {
               for (var addd =
                  0; addd < ad
                  .length; addd++) {
                  if (ad[addd]
                                                                [
                                                                        0
                        ] == XXff) {
                     return ad[addd]
                                                                        [
                                                                                1
                           ];
                  }
               }
            }
            
            function LancementDD(
               results, arrbo, bb,
               menuOne, boula) {
               //console.log("front click ajust");
               var interv;
               var bbb = bb;
               if (!boula) {}
               else {
                  var bboula = boula;
                  boula = boula
                     .split('_');
                  if (boula[0].split(
                        "*")[0] ==
                     "mouse") {
                     boula2 = bboula;
                     document
                        .getElementById(
                           bbb)
                        .addEventListener(
                           "mousedown",
                           bghhemo);
                  }
                  else if (boula[0]
                     .split("*")[
                     0] == "this") {
                     //console.log("front click ajust 2");
                     document
                        .getElementById(
                           bbb)
                        .addEventListener(
                           "mouseout",
                           bghhemo2);
                  }
               }
               if (arrbo != null ||
                  arrbo != "null") {
                  arrbo = arrbo
                     .split('_');
                  if (arrbo[0].split(
                        "*")[0] ==
                     "this") {
                     arrbo = [arrbo[
                           0]
                                                                        , arrbo[
                           1]
                                                                        , arrbo[
                           2]
                                                                        ];
                     //console.log("front click ajust 3" + bbb);
                     document
                        .getElementById(
                           bbb)
                        .addEventListener(
                           "mouseup",
                           bghhe);
                  }
                  if (arrbo[0] ==
                     "replace") {
                     document
                        .getElementById(
                           bbb)
                        .addEventListener(
                           "mouseup",
                           bghhe2);
                  }
               }
               
               function bghhemo() {
                  var dre;
                  for (var sT =
                     0; sT < ad
                     .length; sT++) {
                     if (ad[sT]
                                                                        [
                                                                                0
                           ] ==
                        boula[2]) {
                        //console.log("ici");
                        dre = sT;
                     }
                  }
                  document
                     .getElementById(
                        bbb)
                     .removeEventListener(
                        "mousedown",
                        bghhemo);
                  var cadre = ad[dre]
                                                                [
                                                                        1
                        ];
                  var cool = JSON
                     .parse(cadre);
                  for (var sT =
                     0; sT < cool
                     .item
                     .length; sT++) {
                     if (cool.item[
                           sT]
                        .utilisation
                        .id == bbb
                        .split(
                        "DIV")[1]) {
                        //console.log("test2");
                        cool.item[sT]
                           .utilisation
                           .contour =
                           "this*" +
                           boula[0]
                           .split(
                              "*")[
                           1] + "_" +
                           boula[1] +
                           "_" +
                           boula[2];
                     }
                  }
                  cadre = JSON
                     .stringify(
                     cool);
                  ad[dre][1] = cadre;
                  c1113 = Ce;
                  var VI2 = VI;
                  //document.body.innerHTML = "";
                  //console.log(Ce);
                  ih = Number(
                     document
                     .getElementById(
                        boula[0]
                        .split(
                           "*")[1]
                        )
                     .style.height
                     .split("p")[
                        0]);
                  iw = Number(
                     document
                     .getElementById(
                        boula[0]
                        .split(
                           "*")[1]
                        )
                     .style.width
                     .split("p")[
                        0]);
                  document
                     .getElementById(
                        boula[0]
                        .split("*")[
                           1])
                     .innerHTML = "";
                  if (boula2.split(
                        "_")[0]
                     .split("*")
                     .length == 2) {
                     Ce = boula2
                        .split("_")[
                           0].split(
                           "*")[1];
                  }
                  else {
                     Ce = c1113;
                  }
                  InitialLoadingBounds
                     (boula[2]);
               }
               
               function bghhemo2() {
                  document
                     .getElementById(
                        bbb)
                     .removeEventListener(
                        "mouseout",
                        bghhemo2);
                  //console.log("test");
                  var dre;
                  for (var sT =
                     0; sT < ad
                     .length; sT++) {
                     if (ad[sT]
                                                                        [
                                                                                0
                           ] ==
                        boula[2]) {
                        dre = sT;
                     }
                  }
                  var cadre = ad[dre]
                                                                [
                                                                        1
                        ];
                  /*
                  if (boula2.split("_")[0].split("*").length == 2) {
                  bbb = boula2.split("_")[0].split("*")[1];
                  }
                  */
                  var cool = JSON
                     .parse(cadre);
                  for (var sT =
                     0; sT < cool
                     .item
                     .length; sT++) {
                     if (cool.item[
                           sT]
                        .utilisation
                        .id == bbb
                        .split(
                        "DIV")[1]) {
                        cool.item[sT]
                           .utilisation
                           .contour =
                           "mouse*" +
                           boula2
                           .split(
                              "_")[0]
                           .split(
                              "*")[
                           1] + "_" +
                           boula[1] +
                           "_" +
                           boula[2];
                        //console.log(boula2);
                     }
                  }
                  cadre = JSON
                     .stringify(
                     cool);
                  ad[dre][1] = cadre;
                  c1113 = Ce;
                  var VI2 = VI;
                  //document.body.innerHTML = "";
                  if (boula2.split(
                        "_")[0]
                     .split("*")
                     .length == 2) {
                     Ce = boula2
                        .split("_")[
                           0].split(
                           "*")[1];
                  }
                  else {
                     Ce = c1113;
                  }
                  document
                     .getElementById(
                        Ce)
                     .innerHTML = "";
                  InitialLoadingBounds
                     (boula[2]);
               }
               
               function bghhe() {
                  if (arrbo[0].split(
                        "*")[0] ==
                     "this") {
                     //console.log("front click ajust 4");
                     document
                        .getElementById(
                           bbb)
                        .removeEventListener(
                           "mouseup",
                           bghhe);
                     if (arrbo[0]
                        .split("*")
                        .length == 1
                        ) {
                        var cc =
                           arrbo[1];
                        var VI3 =
                           arrbo[2];
                        EH = (((self
                                    .innerWidth) /
                                 (self
                                    .innerHeight
                                    )
                                 ) *
                              0.49) *
                           getZoom() *
                           VH;
                        EW = 1 *
                           getZoom() *
                           VW;
                        /*
                        LW = Number(self.innerWidth);
                        LH = Number(self.innerHeight);
                        document.getElementById(cc).style.top = Number(LH*ET).toString() + "px";
                        document.getElementById(cc).style.left = Number(LW*EL).toString() + "px";
                        document.getElementById(cc).style.height = Number(LH*EH).toString() + "px";
                        document.getElementById(cc).style.width = Number(LW*EW).toString() + "px";
                        */
                        ih = Number(
                           document
                           .getElementById(
                              cc)
                           .style
                           .height
                           .split(
                              "p"
                              )[0]
                           );
                        iw = Number(
                           document
                           .getElementById(
                              cc)
                           .style
                           .width
                           .split(
                              "p"
                              )[0]
                           );
                        document
                           .getElementById(
                              cc)
                           .innerHTML =
                           "";
                        Ce = cc;
                        VI = VI3;
                        InitialLoadingBounds
                           (VI3);
                     }
                     else if (arrbo[
                           0].split(
                           "*")[1] ==
                        "function") {
                        var VI3 =
                           arrbo[2];
                        //document.getElementById(VI3.split("*")[0]).innerHTML = "";
                        //InitialLoadingBounds(VI3.split("*")[1]);
                     }
                  }
               }
               
               function bghhe2() {
                  //console.log("test");
                  document
                     .getElementById(
                        bbb)
                     .removeEventListener(
                        "mouseup",
                        bghhe2);
                  if (arrbo[0] ==
                     "replace" &&
                     arrbo[1] ==
                     "socket") {
                     Manivelle(arrbo[
                        2]);
                     //console.log(arrbo[2]);
                  }
               }
            }
            
            function AA(Xf) {
               var jesonContent;
               var routes = tbd;
               LanceB();
               
               function LanceB() {
                  jesonContent =
                     routes;
                  var exo = Number(
                     jesonContent
                     .item.length);
                  var as2 = 0;
                  for (var o = 0; o <
                     exo; o++) {
                     var x1;
                     var x2;
                     var w1;
                     var w2;
                     for (var aaaa =
                           0; aaaa <
                        jesonContent
                        .item[o]
                        .geometry
                        .coordinates[
                           0]
                        .length; aaaa++
                        ) {
                        if (aaaa ==
                           0) {
                           w1 =
                              Number
                              .parseFloat(
                                 jesonContent
                                 .item[
                                    o
                                    ]
                                 .geometry
                                 .coordinates[
                                    0
                                    ]
                                                                                                [
                                                                                                        aaaa
                                    ]
                                                                                                [
                                                                                                        0
                                    ]
                                 );
                           w2 =
                              Number
                              .parseFloat(
                                 jesonContent
                                 .item[
                                    o
                                    ]
                                 .geometry
                                 .coordinates[
                                    0
                                    ]
                                                                                                [
                                                                                                        aaaa
                                    ]
                                                                                                [
                                                                                                        0
                                    ]
                                 );
                           x1 =
                              Number
                              .parseFloat(
                                 jesonContent
                                 .item[
                                    o
                                    ]
                                 .geometry
                                 .coordinates[
                                    0
                                    ]
                                                                                                [
                                                                                                        aaaa
                                    ]
                                                                                                [
                                                                                                        1
                                    ]
                                 );
                           x2 =
                              Number
                              .parseFloat(
                                 jesonContent
                                 .item[
                                    o
                                    ]
                                 .geometry
                                 .coordinates[
                                    0
                                    ]
                                                                                                [
                                                                                                        aaaa
                                    ]
                                                                                                [
                                                                                                        1
                                    ]
                                 );
                        }
                        for (var
                              aaaaa =
                              0; aaaaa <
                           jesonContent
                           .item[o]
                           .geometry
                           .coordinates[
                              0]
                           .length; aaaaa++
                           ) {
                           if (Number
                              .parseFloat(
                                 jesonContent
                                 .item[
                                    o
                                    ]
                                 .geometry
                                 .coordinates[
                                    0
                                    ]
                                                                                                [
                                                                                                        aaaaa
                                    ]
                                                                                                [
                                                                                                        1
                                    ]
                                 ) <=
                              x2) {}
                           else {
                              if (
                                 x2 <=
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaaa
                                       ]
                                                                                                        [
                                                                                                                1
                                       ]
                                    )
                                 ) {
                                 x2 =
                                    Number
                                    .parseFloat(
                                       jesonContent
                                       .item[
                                          o
                                          ]
                                       .geometry
                                       .coordinates[
                                          0
                                          ]
                                                                                                                [
                                                                                                                        aaaaa
                                          ]
                                                                                                                [
                                                                                                                        1
                                          ]
                                       );
                              }
                           }
                           if (Number
                              .parseFloat(
                                 jesonContent
                                 .item[
                                    o
                                    ]
                                 .geometry
                                 .coordinates[
                                    0
                                    ]
                                                                                                [
                                                                                                        aaaaa
                                    ]
                                                                                                [
                                                                                                        1
                                    ]
                                 ) >=
                              x1) {}
                           else {
                              if (
                                 x1 >=
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaaa
                                       ]
                                                                                                        [
                                                                                                                1
                                       ]
                                    )
                                 ) {
                                 x1 =
                                    Number
                                    .parseFloat(
                                       jesonContent
                                       .item[
                                          o
                                          ]
                                       .geometry
                                       .coordinates[
                                          0
                                          ]
                                                                                                                [
                                                                                                                        aaaaa
                                          ]
                                                                                                                [
                                                                                                                        1
                                          ]
                                       );
                              }
                           }
                           if (Number
                              .parseFloat(
                                 jesonContent
                                 .item[
                                    o
                                    ]
                                 .geometry
                                 .coordinates[
                                    0
                                    ]
                                                                                                [
                                                                                                        aaaaa
                                    ]
                                                                                                [
                                                                                                        0
                                    ]
                                 ) <=
                              w2) {}
                           else {
                              if (
                                 w2 <=
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaaa
                                       ]
                                                                                                        [
                                                                                                                0
                                       ]
                                    )
                                 ) {
                                 w2 =
                                    Number
                                    .parseFloat(
                                       jesonContent
                                       .item[
                                          o
                                          ]
                                       .geometry
                                       .coordinates[
                                          0
                                          ]
                                                                                                                [
                                                                                                                        aaaaa
                                          ]
                                                                                                                [
                                                                                                                        0
                                          ]
                                       );
                              }
                           }
                           if (Number
                              .parseFloat(
                                 jesonContent
                                 .item[
                                    o
                                    ]
                                 .geometry
                                 .coordinates[
                                    0
                                    ]
                                                                                                [
                                                                                                        aaaaa
                                    ]
                                                                                                [
                                                                                                        0
                                    ]
                                 ) >=
                              w1) {}
                           else {
                              if (
                                 w1 >=
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaaa
                                       ]
                                                                                                        [
                                                                                                                0
                                       ]
                                    )
                                 ) {
                                 w1 =
                                    Number
                                    .parseFloat(
                                       jesonContent
                                       .item[
                                          o
                                          ]
                                       .geometry
                                       .coordinates[
                                          0
                                          ]
                                                                                                                [
                                                                                                                        aaaaa
                                          ]
                                                                                                                [
                                                                                                                        0
                                          ]
                                       );
                              }
                           }
                           if (
                              aaaa ==
                              aaaaa &&
                              aaaaa ==
                              jesonContent
                              .item[
                                 o]
                              .geometry
                              .coordinates[
                                 0]
                              .length -
                              1) {
                              ekt3
                                 .push(
                                    [routes
                                       .item[
                                          o
                                          ]
                                                                                                .utilisation
                                                                                                .id
                                                                                                , w1
                                                                                                , w2
                                                                                                , x1
                                                                                                , x2
                                                                                                ]
                                    );
                              ekt22
                                 .push(
                                    [convert(
                                          w2,
                                          0,
                                          -
                                          1,
                                          1
                                          )
                                                                                                , convert(
                                          0,
                                          x2,
                                          -
                                          1,
                                          1
                                          )
                                                                                                , convert(
                                          w1,
                                          0,
                                          -
                                          1,
                                          1
                                          )
                                                                                                , convert(
                                          0,
                                          x1,
                                          -
                                          1,
                                          1
                                          )
                                                                                                ]
                                    );
                           }
                        }
                     }
                     if (exo - 1 ==
                        o) {
                        LanceCC();
                     }
                  }
               }
               
               function LanceCC() {
                  var canv = document
                     .getElementById(
                        Ce);
                  canv.innerHTML =
                  "";
                  for (var bbbb =
                        routes.item
                        .length -
                        1; bbbb >=
                     0; bbbb--) {
                     var thebop = 0;
                     var thebop2 = 0;
                     for (var bbbb3 =
                           0; bbbb3 <=
                        routes.item
                        .length -
                        1; bbbb3++) {
                        if (routes
                           .item[
                              bbbb]
                           .utilisation
                           .id ==
                           routes
                           .item[
                              bbbb3]
                           .utilisation
                           .id &&
                           bbbb <
                           bbbb3) {
                           thebop +=
                              1;
                        }
                        if (routes
                           .item[
                              bbbb]
                           .utilisation
                           .id ==
                           routes
                           .item[
                              bbbb3]
                           .utilisation
                           .id &&
                           bbbb !=
                           bbbb3) {
                           thebop2
                              = -2;
                        }
                     }
                     if (thebop2 ==
                        0) {
                        smoth(bbbb,
                           Number(
                              routes
                              .item[
                                 bbbb
                                 ]
                              .utilisation
                              .Ordre
                              ));
                     }
                     else if (
                        thebop == 0
                        ) {
                        smoth(bbbb,
                           Number(
                              routes
                              .item[
                                 bbbb
                                 ]
                              .utilisation
                              .Ordre
                              ));
                     }
                     else {
                        console.log(
                           "erreur conflit d'identifiants"
                           );
                     }
                  }
                  var imgo;
                  
                  function smoth(
                     bbbb2, radie) {
                     exea(Ra);
                     
                     function exea(
                        condi) {
                        jesonContent
                           = routes;
                        if ((typeof radie ==
                              "number"
                              )) {
                           var divd3 =
                              document
                              .createElement(
                                 "div"
                                 );
                           divd3.id =
                              "DIV" +
                              routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .id;
                           divd3
                              .style
                              .position =
                              'absolute';
                           divd3
                              .style
                              .height =
                              Number(
                                 (ekt22[
                                       bbbb2
                                       ]
                                                                                                        [
                                                                                                                1
                                       ]
                                    ) -
                                 (ekt22[
                                       bbbb2
                                       ]
                                                                                                        [
                                                                                                                3
                                       ]
                                    )
                                 )
                              .toString() +
                              "px";
                           divd3
                              .style
                              .width =
                              Number(
                                 (ekt22[
                                       bbbb2
                                       ]
                                                                                                        [
                                                                                                                0
                                       ]
                                    ) -
                                 (ekt22[
                                       bbbb2
                                       ]
                                                                                                        [
                                                                                                                2
                                       ]
                                    )
                                 )
                              .toString() +
                              "px";
                           divd3
                              .style
                              .zIndex =
                              radie
                              .toString();
                           divd3
                              .style
                              .top =
                              Number(
                                 (-ih +
                                    ekt22[
                                       bbbb2
                                       ]
                                                                                                        [
                                                                                                                3
                                       ]
                                    ) *
                                 -1)
                              .toString() +
                              "px";
                           divd3
                              .align =
                              "left";
                           if (!
                              routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .contour
                              ) {}
                           else if (
                              routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .contour
                              .split(
                                 "*")
                              .length ==
                              2) {
                              divd3
                                 .style
                                 .border =
                                 routes
                                 .item[
                                    bbbb2
                                    ]
                                 .utilisation
                                 .contour
                                 .split(
                                    "*"
                                    )[
                                    1
                                    ] +
                                 "px solid " +
                                 routes
                                 .item[
                                    bbbb2
                                    ]
                                 .utilisation
                                 .contour
                                 .split(
                                    "*"
                                    )[
                                    0
                                    ];
                           }
                           divd3
                              .style
                              .left =
                              Number(
                                 ekt22[
                                    bbbb2
                                    ]
                                                                                                [
                                                                                                        2
                                    ]
                                 )
                              .toString() +
                              "px";
                           var yop =
                              '<canvas id="';
                           yop += ""
                           yop +=
                              routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .id;
                           yop +=
                              '" height="';
                           yop +=
                              Number(
                                 Number(
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                1
                                          ]
                                       ) -
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                3
                                          ]
                                       )
                                    )
                                 )
                              .toString();
                           yop +=
                              '" width="';
                           yop +=
                              Number(
                                 Number(
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                0
                                          ]
                                       ) -
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                2
                                          ]
                                       )
                                    )
                                 )
                              .toString();
                           yop +=
                           '"';
                           yop +=
                              " style='top:0px; left:0px; height:0px; position:absolute;";
                           yop +=
                              " width:0px;";
                           yop +=
                           "'";
                           yop +=
                              ' > ';
                           yop +=
                              '</canvas> ';
                           yop +=
                              "<div";
                           yop +=
                              " style='height:";
                           yop +=
                              Number(
                                 Number(
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                1
                                          ]
                                       ) -
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                3
                                          ]
                                       )
                                    )
                                 )
                              .toString() +
                              "px";
                           yop +=
                              "; position:absolute; z-index:";
                           yop += (
                                 radie -
                                 1)
                              .toString();
                           yop +=
                              "; width:";
                           yop +=
                              Number(
                                 Number(
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                0
                                          ]
                                       ) -
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                2
                                          ]
                                       )
                                    )
                                 )
                              .toString() +
                              "px";
                           yop +=
                              ";' ";
                           if (routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .route
                              .split(
                                 "_"
                                 )[0]
                              .split(
                                 "*")
                              .length ==
                              2 &&
                              routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .route
                              .split(
                                 "_"
                                 )[0]
                              .split(
                                 "*"
                                 )[
                              1] ==
                              "function"
                              ) {
                              yop +=
                                 "onclick='" +
                                 routes
                                 .item[
                                    bbbb2
                                    ]
                                 .utilisation
                                 .route
                                 .split(
                                    "_"
                                    )[
                                    1
                                    ] +
                                 "'";
                           }
                           yop +=
                           ">";
                           if (routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .utiliser
                              .split(
                                 '#*#'
                                 )
                              .length ==
                              1) {
                              yop +=
                                 routes
                                 .item[
                                    bbbb2
                                    ]
                                 .utilisation
                                 .utiliser;
                           }
                           yop +=
                              "</div>";
                           divd3
                              .innerHTML =
                              yop;
                           document
                              .getElementById(
                                 Ce)
                              .appendChild(
                                 divd3
                                 );
                           var canvd3 =
                              document
                              .getElementById(
                                 (routes
                                    .item[
                                       bbbb2
                                       ]
                                    .utilisation
                                    .id
                                    )
                                 );
                           canvd3
                              .style
                              .position =
                              'absolute';
                           canvd3
                              .style
                              .zIndex =
                              (radie -
                                 2)
                              .toString();
                           var canvde =
                              document
                              .getElementById(
                                 "DIV" +
                                 routes
                                 .item[
                                    bbbb2
                                    ]
                                 .utilisation
                                 .id
                                 );
                           canvde
                              .style
                              .height =
                              Number(
                                 ((ekt22[
                                          bbbb2]
                                       [
                                                                                                        1
                                          ]
                                       ) -
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                3
                                          ]
                                       )
                                    )
                                 )
                              .toString() +
                              "px";
                           canvde
                              .style
                              .width =
                              Number(
                                 ((ekt22[
                                          bbbb2]
                                       [
                                                                                                        0
                                          ]
                                       ) -
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                2
                                          ]
                                       )
                                    )
                                 )
                              .toString() +
                              "px";
                           canvd3
                              .style
                              .height =
                              Number(
                                 ((ekt22[
                                          bbbb2]
                                       [
                                                                                                        1
                                          ]
                                       ) -
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                3
                                          ]
                                       )
                                    )
                                 )
                              .toString() +
                              "px";
                           canvd3
                              .style
                              .width =
                              Number(
                                 ((ekt22[
                                          bbbb2]
                                       [
                                                                                                        0
                                          ]
                                       ) -
                                    (ekt22[
                                          bbbb2
                                          ]
                                                                                                        [
                                                                                                                2
                                          ]
                                       )
                                    )
                                 )
                              .toString() +
                              "px";
                           canvde
                              .style
                              .zIndex =
                              (radie)
                              .toString();
                           canvde
                              .style
                              .top =
                              Number(
                                 (-ih +
                                    ekt22[
                                       bbbb2
                                       ]
                                                                                                        [
                                                                                                                1
                                       ]
                                    ) *
                                 -1)
                              .toString() +
                              "px";
                           canvde
                              .align =
                              "left";
                           canvde
                              .style
                              .left =
                              Number(
                                 ekt22[
                                    bbbb2
                                    ]
                                                                                                [
                                                                                                        2
                                    ]
                                 )
                              .toString() +
                              "px";
                        }
                        cli(canvd3,
                           routes
                           .item[
                              bbbb2
                              ]
                           .utilisation
                           .route,
                           canvde
                           .id,
                           routes
                           .item[
                              bbbb2
                              ]
                           .utilisation
                           .utiliser,
                           bbbb2,
                           routes
                           .item[
                              bbbb2
                              ]
                           .utilisation
                           .contour
                           );
                        //routes.item[bbbb2].utilisation.id
                        var ctx =
                           canvd3
                           .getContext(
                              '2d', {
                                 willReadFrequently: true
                              });
                        var
                     poly = [];
                        var ppow =
                           Number(((ekt22[
                                    bbbb2
                                    ]
                                 [
                                                                                                0
                                    ]
                                 ) -
                              (ekt22[
                                    bbbb2
                                    ]
                                                                                                [
                                                                                                        2
                                    ]
                                 )
                              ));
                        var ppoh =
                           Number(((ekt22[
                                    bbbb2
                                    ]
                                 [
                                                                                                1
                                    ]
                                 ) -
                              (ekt22[
                                    bbbb2
                                    ]
                                                                                                [
                                                                                                        3
                                    ]
                                 )
                              ));
                        var hhhx = 0;
                        var hhhy = 0;
                        var hhhy22 =
                           0;
                        for (var
                              aaaa =
                              0; aaaa <
                           routes
                           .item[
                              bbbb2]
                           .geometry
                           .coordinates[
                              0]
                           .length; aaaa++
                           ) {
                           hhhx =
                              convert(
                                 0,
                                 routes
                                 .item[
                                    bbbb2
                                    ]
                                 .geometry
                                 .coordinates[
                                    0
                                    ]
                                                                                        [
                                                                                                aaaa
                                    ]
                                                                                        [
                                                                                                1
                                    ],
                                 bbbb2,
                                 ppoh
                                 );
                           hhhy =
                              convert(
                                 routes
                                 .item[
                                    bbbb2
                                    ]
                                 .geometry
                                 .coordinates[
                                    0
                                    ]
                                                                                        [
                                                                                                aaaa
                                    ]
                                                                                        [
                                                                                                0
                                    ],
                                 0,
                                 bbbb2,
                                 ppow
                                 );
                           poly.push(
                              hhhy
                              );
                           poly.push(
                              hhhx
                              );
                        }
                        var image =
                           new Image();
                        var pattern;
                        
                        function LoadImages() {
                           ctx
                        .beginPath();
                           
                           function draww(
                              conte
                              ) {
                              if (
                                 conte ==
                                 0) {
                                 if (
                                    routes
                                    .item[
                                       bbbb2
                                       ]
                                    .utilisation
                                    .couleur !=
                                    "null"
                                    ) {
                                    if (
                                       routes
                                       .item[
                                          bbbb2
                                          ]
                                       .utilisation
                                       .couleur
                                       .split(
                                          "~"
                                          )[
                                          0
                                          ] ==
                                       "LoadImage"
                                       ) {
                                       pattern
                                          =
                                          ctx
                                          .createPattern(
                                             imagefinali,
                                             "no-repeat"
                                             );
                                    }
                                    else if (
                                       routes
                                       .item[
                                          bbbb2
                                          ]
                                       .utilisation
                                       .couleur
                                       .split(
                                          "~"
                                          )[
                                          0
                                          ] ==
                                       "stroke"
                                       ) {
                                       pattern
                                          =
                                          routes
                                          .item[
                                             bbbb2
                                             ]
                                          .utilisation
                                          .couleur
                                          .split(
                                             "~"
                                             )[
                                             1
                                             ];
                                       ctx.strokeStyle =
                                          "black";
                                    }
                                    else {
                                       pattern
                                          =
                                          routes
                                          .item[
                                             bbbb2
                                             ]
                                          .utilisation
                                          .couleur;
                                    }
                                 }
                                 else {
                                    pattern
                                       =
                                       "rgba(0,0,0,1)";
                                    ctx.strokeStyle =
                                       "black";
                                 }
                              }
                              else {
                                 pattern
                                    =
                                    routes
                                    .item[
                                       bbbb2
                                       ]
                                    .utilisation
                                    .contour
                                    .split(
                                       "_"
                                       )[
                                       1
                                       ];
                              }
                              ctx.fillStyle =
                                 pattern;
                              ctx.moveTo(
                                 poly[
                                    0
                                    ],
                                 poly[
                                    1
                                    ]
                                 );
                              if (
                                 routes
                                 .item[
                                    bbbb2
                                    ]
                                 .utilisation
                                 .contour ==
                                 "arc"
                                 ) {
                                 ctx.arcTo(
                                    poly[
                                       0
                                       ],
                                    poly[
                                       1
                                       ],
                                    poly[
                                       2
                                       ],
                                    poly[
                                       3
                                       ],
                                    100
                                    );
                                 for (
                                    item =
                                    0; item <
                                    poly
                                    .length -
                                    1; item +=
                                    2
                                    ) {
                                    if (
                                       item <
                                       poly
                                       .length -
                                       3
                                       ) {
                                       var calcpp =
                                          (poly[item +
                                                4
                                                ] +
                                             poly[
                                                item +
                                                5
                                                ]
                                             ) -
                                          (poly[item +
                                                2
                                                ] +
                                             poly[
                                                item +
                                                3
                                                ]
                                             );
                                       ctx.arcTo(
                                          poly[
                                             item +
                                             2
                                             ],
                                          poly[
                                             item +
                                             3
                                             ],
                                          poly[
                                             item +
                                             4
                                             ],
                                          poly[
                                             item +
                                             5
                                             ],
                                          100
                                          );
                                    }
                                    else if (
                                       item <
                                       poly
                                       .length -
                                       1
                                       ) {
                                       ctx.arcTo(
                                          poly[
                                             0
                                             ],
                                          poly[
                                             1
                                             ],
                                          poly[
                                             2
                                             ],
                                          poly[
                                             3
                                             ],
                                          100
                                          );
                                    }
                                 }
                              }
                              else {
                                 ctx.lineTo(
                                    poly[
                                       0
                                       ],
                                    poly[
                                       1
                                       ]
                                    );
                                 for (
                                    item =
                                    0; item <
                                    poly
                                    .length -
                                    1; item +=
                                    2
                                    ) {
                                    if (
                                       item <
                                       poly
                                       .length -
                                       3
                                       ) {
                                       ctx.lineTo(
                                          poly[
                                             item +
                                             2
                                             ],
                                          poly[
                                             item +
                                             3
                                             ]
                                          );
                                    }
                                    else if (
                                       item <
                                       poly
                                       .length -
                                       1
                                       ) {}
                                 }
                              }
                              ctx
                           .fill();
                              ctx
                           .closePath();
                           }
                           draww(0);
                           if (routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .utiliser
                              .split(
                                 '#*#'
                                 )
                              .length ==
                              4) {
                              var arrPutText =
                                 routes
                                 .item[
                                    bbbb2
                                    ]
                                 .utilisation
                                 .utiliser
                                 .split(
                                    '#*#'
                                    );
                              putText
                                 (canvd3,
                                    ctx,
                                    Number(
                                       arrPutText[
                                          0
                                          ]
                                       ),
                                    arrPutText[
                                       1
                                       ],
                                    parseInt(
                                       Number(
                                          arrPutText[
                                             0
                                             ]
                                          ) *
                                       1.286
                                       ),
                                    arrPutText[
                                       2
                                       ],
                                    arrPutText[
                                       3
                                       ]
                                    );
                              // 0 = taille 1 = police 2 = color 3 = texte
                           }
                           ctx
                        .beginPath();
                           if (!
                              routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .contour
                              ) {}
                           else if (
                              routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .contour
                              .split(
                                 "_"
                                 )[0]
                              .split(
                                 "*"
                                 )[
                              0] ==
                              "this" &&
                              routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .contour !=
                              "null"
                              ) {
                              ctx.globalCompositeOperation =
                                 'source-in';
                              ctx.fillStyle =
                                 routes
                                 .item[
                                    bbbb2
                                    ]
                                 .utilisation
                                 .contour
                                 .split(
                                    "_"
                                    )[
                                    1
                                    ];
                              ctx.moveTo(
                                 poly[
                                    0
                                    ],
                                 poly[
                                    1
                                    ]
                                 );
                              ctx.lineTo(
                                 poly[
                                    0
                                    ],
                                 poly[
                                    1
                                    ]
                                 );
                              for (
                                 item =
                                 0; item <
                                 poly
                                 .length -
                                 1; item +=
                                 2) {
                                 if (
                                    item <
                                    poly
                                    .length -
                                    3
                                    ) {
                                    ctx.lineTo(
                                       poly[
                                          item +
                                          2
                                          ],
                                       poly[
                                          item +
                                          3
                                          ]
                                       );
                                 }
                                 else if (
                                    item <
                                    poly
                                    .length -
                                    1
                                    ) {}
                              }
                              ctx
                           .closePath();
                              ctx
                           .beginPath();
                              ctx.globalCompositeOperation =
                                 'multiply';
                              draww(
                                 1);
                           }
                           canvd3
                              .update;
                        }
                        if (routes
                           .item[
                              bbbb2]
                           .utilisation
                           .couleur
                           .split(
                              "~")[
                           0] ==
                           "LoadImage"
                           ) {
                           var imagefinali =
                              new Image();
                           imagefinali
                              .onload =
                              function () {
                                 LoadImages
                                    ();
                              };
                           image
                              .onload =
                              function () {
                                 document
                                    .getElementById(
                                       "loaderCanvases"
                                       )
                                    .height =
                                    Number(
                                       canvde
                                       .style
                                       .height
                                       .split(
                                          "p"
                                          )[
                                          0
                                          ] *
                                       condi
                                       );
                                 document
                                    .getElementById(
                                       "loaderCanvases"
                                       )
                                    .width =
                                    Number(
                                       canvde
                                       .style
                                       .width
                                       .split(
                                          "p"
                                          )[
                                          0
                                          ] *
                                       condi
                                       );
                                 document
                                    .getElementById(
                                       "loaderCanvases"
                                       )
                                    .getContext(
                                       "2d",
                                       {
                                          willReadFrequently: true
                                       }
                                       )
                                    .drawImage(
                                       image,
                                       -
                                       ((condi -
                                             1
                                             ) *
                                          (canvde
                                             .style
                                             .width
                                             .split(
                                                "p"
                                                )[
                                                0
                                                ] /
                                             2
                                             )
                                          ),
                                       0,
                                       Number(
                                          canvde
                                          .style
                                          .width
                                          .split(
                                             "p"
                                             )[
                                             0
                                             ] *
                                          condi
                                          ),
                                       Number(
                                          canvde
                                          .style
                                          .height
                                          .split(
                                             "p"
                                             )[
                                             0
                                             ] *
                                          condi
                                          )
                                       );
                                 document
                                    .getElementById(
                                       "loaderIMG"
                                       )
                                    .style
                                    .height =
                                    Number(
                                       canvd3
                                       .style
                                       .height
                                       .split(
                                          "p"
                                          )[
                                          0
                                          ] *
                                       condi
                                       )
                                    .toString() +
                                    "px";
                                 document
                                    .getElementById(
                                       "loaderIMG"
                                       )
                                    .style
                                    .width =
                                    Number(
                                       canvd3
                                       .style
                                       .width
                                       .split(
                                          "p"
                                          )[
                                          0
                                          ] *
                                       condi
                                       )
                                    .toString() +
                                    "px";
                                 document
                                    .getElementById(
                                       "loaderIMG"
                                       )
                                    .src =
                                    image
                                    .src; //document.getElementById("loaderCanvases").toDataURL('image/png'); 
                                 imagefinali
                                    .height =
                                    Number(
                                       canvde
                                       .style
                                       .height
                                       .split(
                                          "p"
                                          )[
                                          0
                                          ] *
                                       condi
                                       );
                                 imagefinali
                                    .width =
                                    Number(
                                       canvde
                                       .style
                                       .width
                                       .split(
                                          "p"
                                          )[
                                          0
                                          ] *
                                       condi
                                       );
                                 imagefinali
                                    .src =
                                    document
                                    .getElementById(
                                       "loaderIMG"
                                       )
                                    .src;
                              };
                           image
                              .height =
                              Number(
                                 canvde
                                 .style
                                 .height
                                 .split(
                                    "p"
                                    )[
                                    0
                                    ] *
                                 condi
                                 );
                           image
                              .width =
                              Number(
                                 canvde
                                 .style
                                 .width
                                 .split(
                                    "p"
                                    )[
                                    0
                                    ] *
                                 condi
                                 );
                           image
                              .src =
                              routes
                              .item[
                                 bbbb2
                                 ]
                              .utilisation
                              .couleur
                              .split(
                                 "~"
                                 )[
                              1];
                        }
                        else {
                           LoadImages
                              ();
                        }
                        if (bbbb2 ==
                           routes
                           .item
                           .length -
                           1) {}
                     };
                  };
               }
               
               function convert(lat,
                  lng, opp, pourcent,
                  opp2) {
                  if (!opp2) {
                     opp2 = 0;
                  }
                  if (pourcent < 2) {
                     var MAP_HEIGHT =
                        ih *
                        pourcent;
                     var MAP_WIDTH =
                        iw *
                        pourcent;
                  }
                  else {
                     var MAP_HEIGHT =
                        pourcent;
                     var MAP_WIDTH =
                        pourcent;
                  }
                  //extents of bounding box
                  if (opp != -1) {
                     var e2 =
                        parseFloat(
                           ekt3[opp]
                                                                        [
                                                                                2
                              ] +
                           opp2
                           ); //eastern boundary latitude
                     var w2 =
                        parseFloat(
                           ekt3[opp]
                                                                        [
                                                                                1
                              ] +
                           opp2
                           ); //western boundary latitude
                     var n2 =
                        parseFloat(
                           ekt3[opp]
                                                                        [
                                                                                4
                              ] +
                           opp2
                           ); //north boundary longitude
                     var s2 =
                        parseFloat(
                           ekt3[opp]
                                                                        [
                                                                                3
                              ] +
                           opp2
                           ); //south boundary longitude
                  }
                  else {
                     var e2 =
                        parseFloat(
                           W22
                           ); //eastern boundary latitude
                     var w2 =
                        parseFloat(
                           W11
                           ); //western boundary latitude
                     var n2 =
                        parseFloat(
                           X11
                           ); //north boundary longitude
                     var s2 =
                        parseFloat(
                           X22
                           ); //south boundary longitude
                  }
                  //calculate extents based on differences, convert to positive values 
                  var nsspan = Math
                     .abs(n2 - s2);
                  var ewspan = Math
                     .abs(w2 - e2);
                  var nspix =
                     MAP_HEIGHT /
                     nsspan; //gives you how many pixels in a lng point
                  var ewpix =
                     MAP_WIDTH /
                     ewspan; //gives you how many pixels in a lat point
                  var x2 = (Math.abs(
                        w2 - lat)) *
                     ewpix; //the difference between the western (right) edge of the box and the point in question, multiplied by pixels per point
                  var y2 = (Math.abs(
                        n2 - lng)) *
                     nspix; //the difference between the northern (top) edge of the box and the point in question, multiplied by pixels per point
                  if (lat == 0) {
                     return y2;
                  }
                  else if (lng ==
                     0) {
                     return x2;
                  }
               }
               
               function cli(thit, id,
                  buildi66, opp,
                  aapp, pm) {
                  if (id != "null") {
                     //console.log(buildi66);
                     LancementDD(
                        thit, id,
                        buildi66,
                        opp, pm);
                  }
               }
            }
            
            function InitialLoadingBounds(
               frakt) {
               X11 = 0;
               X22 = 0;
               W11 = 0;
               W22 = 0;
               ekt3 = [];
               ekt22 = [];
               var ekt2 = [];
               lA(frakt);
               
               function lA(Xf) {
                  var routes =
                  "rien";
                  var lload;
                  //console.log(Xf);
                  routes = JSON
                     .parse(
                        datacollei(
                           Xf));
                  tbd = routes;
                  LanceB();
                  
                  function LanceB() {
                     var jesonContent =
                        routes;
                     var exo =
                        Number(routes
                           .item
                           .length);
                     var as2 = 0;
                     var w1;
                     var x1;
                     w1 = 0;
                     x1 = 0;
                     var w2 = 0;
                     var x2 = 0;
                     for (var o =
                        0; o <
                        exo; o++) {
                        for (var
                              aaaaa =
                              0; aaaaa <
                           jesonContent
                           .item[o]
                           .geometry
                           .coordinates[
                              0]
                           .length; aaaaa++
                           ) {
                           if (o ==
                              0 &&
                              aaaaa ==
                              0) {
                              w1 =
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaaa
                                       ]
                                                                                                        [
                                                                                                                0
                                       ]
                                    );
                              w2 =
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaaa
                                       ]
                                                                                                        [
                                                                                                                0
                                       ]
                                    );
                              x1 =
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaaa
                                       ]
                                                                                                        [
                                                                                                                1
                                       ]
                                    );
                              x2 =
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaaa
                                       ]
                                                                                                        [
                                                                                                                1
                                       ]
                                    );
                           }
                           for (var
                                 aaaa =
                                 0; aaaa <
                              jesonContent
                              .item[
                                 o]
                              .geometry
                              .coordinates[
                                 0]
                              .length; aaaa++
                              ) {
                              if (
                                 w1 -
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaa
                                       ]
                                                                                                        [
                                                                                                                0
                                       ]
                                    ) >
                                 0
                                 ) {}
                              else {
                                 w1 =
                                    Number
                                    .parseFloat(
                                       jesonContent
                                       .item[
                                          o
                                          ]
                                       .geometry
                                       .coordinates[
                                          0
                                          ]
                                                                                                                [
                                                                                                                        aaaa
                                          ]
                                                                                                                [
                                                                                                                        0
                                          ]
                                       );
                              }
                              if (
                                 w2 -
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaa
                                       ]
                                                                                                        [
                                                                                                                0
                                       ]
                                    ) <
                                 0
                                 ) {}
                              else {
                                 w2 =
                                    Number
                                    .parseFloat(
                                       jesonContent
                                       .item[
                                          o
                                          ]
                                       .geometry
                                       .coordinates[
                                          0
                                          ]
                                                                                                                [
                                                                                                                        aaaa
                                          ]
                                                                                                                [
                                                                                                                        0
                                          ]
                                       );
                              }
                              if (
                                 x1 -
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaa
                                       ]
                                                                                                        [
                                                                                                                1
                                       ]
                                    ) >
                                 0
                                 ) {}
                              else {
                                 x1 =
                                    Number
                                    .parseFloat(
                                       jesonContent
                                       .item[
                                          o
                                          ]
                                       .geometry
                                       .coordinates[
                                          0
                                          ]
                                                                                                                [
                                                                                                                        aaaa
                                          ]
                                                                                                                [
                                                                                                                        1
                                          ]
                                       );
                              }
                              if (
                                 x2 -
                                 Number
                                 .parseFloat(
                                    jesonContent
                                    .item[
                                       o
                                       ]
                                    .geometry
                                    .coordinates[
                                       0
                                       ]
                                                                                                        [
                                                                                                                aaaa
                                       ]
                                                                                                        [
                                                                                                                1
                                       ]
                                    ) <
                                 0
                                 ) {}
                              else {
                                 x2 =
                                    Number
                                    .parseFloat(
                                       jesonContent
                                       .item[
                                          o
                                          ]
                                       .geometry
                                       .coordinates[
                                          0
                                          ]
                                                                                                                [
                                                                                                                        aaaa
                                          ]
                                                                                                                [
                                                                                                                        1
                                          ]
                                       );
                              }
                           }
                           if (
                              aaaaa ==
                              jesonContent
                              .item[
                                 o]
                              .geometry
                              .coordinates[
                                 0]
                              .length -
                              1 &&
                              o ==
                              jesonContent
                              .item
                              .length -
                              1 &&
                              ekt2
                              .length ==
                              0) {
                              W11 =
                                 w2;
                              W22 =
                                 w1;
                              X11 =
                                 x2;
                              X22 =
                                 x1;
                              ekt2
                                 .push(
                                    o
                                    );
                              ekt2
                                 .push(
                                    o
                                    );
                              ekt2
                                 .push(
                                    o
                                    );
                              ekt2
                                 .push(
                                    o
                                    );
                           }
                           if (ekt2
                              .length ==
                              4) {
                              break;
                           }
                        }
                        if (ekt2
                           .length ==
                           4) {
                           break;
                        }
                     }
                     if (ekt2
                        .length == 4
                        ) {
                        AA(frakt);
                     }
                  }
               }
            }
            
            function putText(
               caneuvas, ContentX,
               fontsize, fontface,
               lineHeight, colorim,
               text) {
               lineHeight *= 2.2;
               var cw = caneuvas
                  .width;
               var ch = caneuvas
                  .height;
               var words = text
                  .replace(/\n/g,
                     ' \n ')
                  .split(' ');
               var wordWidths = [];
               fontsize = (self
                     .innerWidth /
                     1600) * (
                     fontsize * 2.1
                     ) * getZoom();
               ContentX.font =
                  fontsize + 'px ' +
                  fontface;
               for (var i = 0; i <
                  words.length; i++
                  ) {
                  wordWidths.push(
                     ContentX
                     .measureText(
                        words[i])
                     .width);
               }
               var spaceWidth =
                  ContentX
                  .measureText(' ')
                  .width;
               var wordIndex = 0
               var data = [];
               // fill heart with text
               ContentX.fillStyle =
                  colorim;
               var imgDataData =
                  ContentX
                  .getImageData(0, 0,
                     cw, ch)
                  .data;
               for (var i = 0; i <
                  imgDataData
                  .length; i += 4) {
                  data.push(
                     imgDataData[
                        i + 3]);
               }
               coordinatesWords();
               // draw words sequentially into next available block of 
               //    available opaque pixels 
               function coordinatesWords() {
                  var sx = 0;
                  var sy = 0;
                  var y = 0;
                  var wordIndex = 0;
                  ContentX
                     .textBaseline =
                     'top';
                  while (y < ch &&
                     wordIndex <
                     words.length) {
                     sx = 0;
                     sy = y;
                     var startingIndex =
                        wordIndex;
                     while (sx <
                        cw &&
                        wordIndex <
                        words
                        .length &&
                        words[
                           wordIndex
                           ] != '\n'
                        ) {
                        var x =
                           getRect(
                              sx, sy,
                              lineHeight
                              );
                        var available =
                           x - sx;
                        var spacer =
                           spaceWidth; // spacer=0 to have no left margin
                        var w =
                           spacer +
                           wordWidths[
                              wordIndex
                              ];
                        while (
                           available >=
                           w &&
                           words[
                              wordIndex
                              ] !=
                           '\n') {
                           ContentX
                              .fillText(
                                 words[
                                    wordIndex
                                    ],
                                 spacer +
                                 sx,
                                 sy);
                           sx += w;
                           available
                              -= w;
                           spacer =
                              spaceWidth;
                           wordIndex++;
                           w = spacer +
                              wordWidths[
                                 wordIndex
                                 ];
                        }
                        sx = x + 1;
                     }
                     if (words[
                           wordIndex
                           ] == '\n'
                        ) {
                        wordIndex++;
                     }
                     y = (wordIndex >
                           startingIndex
                           ) ? y +
                        lineHeight :
                        y + 1;
                  }
               }
               // find a rectangular block of opaque pixels
               function getRect(sx,
                  sy, height) {
                  var x = sx;
                  var y = sy;
                  var ok = true;
                  while (ok) {
                     if (data[y *
                           cw + x] <
                        250) {
                        ok = false;
                     }
                     y++;
                     if (y >= sy +
                        height) {
                        y = sy;
                        x++;
                        if (x >=
                           cw) {
                           ok =
                           false;
                        }
                     }
                  }
                  return (x);
               }
            }
            
            function getZoom() {
               if (zm) {
                  return (window
                     .devicePixelRatio
                     );
               }
               else {
                  return 1;
               }
            }
            return {
               autoZoom: function (
               B) {
                  if (typeof B ==
                     "boolean") {
                     zm = B;
                  }
                  else {
                     console.log(
                        "prog.autoZoom() dois être définie sur un boolean"
                        );
                  }
               }
               , Activer: function () {
                  return {
                     autoRedimention: function (
                        VIp,
                        VVi) {
                        window
                           .onresize =
                           function () {
                              EH =
                                 (((self
                                          .innerWidth) /
                                       (self
                                          .innerHeight
                                          ) *
                                       0.49
                                       ) *
                                    (
                                    getZoom()) *
                                    VH
                                    );
                              EW =
                                 (0.99 *
                                    getZoom() *
                                    VW
                                    );
                              LW =
                                 Number(
                                    self
                                    .innerWidth
                                    );
                              LH =
                                 Number(
                                    self
                                    .innerHeight
                                    );
                              document
                                 .getElementById(
                                    Ce
                                    )
                                 .style
                                 .top =
                                 Number(
                                    LH *
                                    ET
                                    )
                                 .toString() +
                                 "px";
                              document
                                 .getElementById(
                                    Ce
                                    )
                                 .style
                                 .left =
                                 Number(
                                    LW *
                                    EL
                                    )
                                 .toString() +
                                 "px";
                              document
                                 .getElementById(
                                    Ce
                                    )
                                 .style
                                 .height =
                                 Number(
                                    LH *
                                    EH
                                    )
                                 .toString() +
                                 "px";
                              document
                                 .getElementById(
                                    Ce
                                    )
                                 .style
                                 .width =
                                 Number(
                                    LW *
                                    EW
                                    )
                                 .toString() +
                                 "px";
                              ih =
                                 Number(
                                    document
                                    .getElementById(
                                       Ce
                                       )
                                    .style
                                    .height
                                    .split(
                                       "p"
                                       )[
                                       0
                                       ]
                                    );
                              iw =
                                 Number(
                                    document
                                    .getElementById(
                                       Ce
                                       )
                                    .style
                                    .width
                                    .split(
                                       "p"
                                       )[
                                       0
                                       ]
                                    );
                              if (
                                 !
                                 VIp
                                 ) {
                                 //document.getElementById(VVi).innerHTML = "";
                                 Ce =
                                    VVi;
                                 InitialLoadingBounds
                                    (
                                       VI);
                              }
                              else {
                                 CCC
                              ();
                              }
                           }
                     }
                     , ChargerPage: function (
                        c, VI2,
                        bool,
                        bool2
                        ) {
                        //document.body.innerHTML = "";
                        if (!
                           document
                           .getElementById(
                              "loaderCanvases"
                              )
                           ) {
                           var divdrr =
                              document
                              .createElement(
                                 "canvas"
                                 );
                           divdrr
                              .id =
                              "loaderCanvases";
                           divdrr
                              .width =
                              "0";
                           divdrr
                              .height =
                              "0";
                           divdrr
                              .hidden =
                              true;
                           document
                              .body
                              .appendChild(
                                 divdrr
                                 );
                           var divdrr2 =
                              document
                              .createElement(
                                 "img"
                                 );
                           divdrr2
                              .id =
                              "loaderIMG";
                           divdrr2
                              .width =
                              "0";
                           divdrr2
                              .height =
                              "0";
                           divdrr2
                              .hidden =
                              true;
                           document
                              .body
                              .appendChild(
                                 divdrr2
                                 );
                        }
                        if (
                           bool2 &&
                           !
                           document
                           .getElementById(
                              c
                              )
                           ) {
                           var divd3 =
                              document
                              .createElement(
                                 "div"
                                 );
                           divd3
                              .id =
                              c;
                           document
                              .body
                              .appendChild(
                                 divd3
                                 );
                        }
                        if (
                           bool
                           ) {
                           EH =
                              (((self
                                       .innerWidth) /
                                    (self
                                       .innerHeight
                                       ) *
                                    0.49
                                    ) *
                                 (
                                 getZoom()) *
                                 VH
                                 );
                           EW =
                              (0.99 *
                                 getZoom() *
                                 VW
                                 );
                           LW =
                              Number(
                                 self
                                 .innerWidth
                                 );
                           LH =
                              Number(
                                 self
                                 .innerHeight
                                 );
                           document
                              .getElementById(
                                 c
                                 )
                              .style
                              .position =
                              'absolute';
                           document
                              .getElementById(
                                 c
                                 )
                              .style
                              .top =
                              Number(
                                 LH *
                                 ET
                                 )
                              .toString() +
                              "px";
                           document
                              .getElementById(
                                 c
                                 )
                              .style
                              .left =
                              Number(
                                 LW *
                                 EL
                                 )
                              .toString() +
                              "px";
                           document
                              .getElementById(
                                 c
                                 )
                              .style
                              .height =
                              Number(
                                 LH *
                                 EH
                                 )
                              .toString() +
                              "px";
                           document
                              .getElementById(
                                 c
                                 )
                              .style
                              .width =
                              Number(
                                 LW *
                                 EW
                                 )
                              .toString() +
                              "px";
                        }
                        ih =
                           Number(
                              document
                              .getElementById(
                                 c
                                 )
                              .style
                              .height
                              .split(
                                 "p"
                                 )[
                                 0
                                 ]
                              );
                        iw =
                           Number(
                              document
                              .getElementById(
                                 c
                                 )
                              .style
                              .width
                              .split(
                                 "p"
                                 )[
                                 0
                                 ]
                              );
                        /*

                        */
                        document
                           .getElementById(
                              c
                              )
                           .innerHTML =
                           "";
                        Ce = c;
                        InitialLoadingBounds
                           (
                              VI2);
                     }
                  }
               }
               , ajouterGeometry: function (
                  NN, GN) {
                  var non = -1;
                  for (var sT =
                     0; sT < ad
                     .length; sT++
                     ) {
                     if (ad[sT]
                                                                        [
                                                                                0
                           ] == NN
                        ) {
                        non = sT;
                     }
                  }
                  if (non != -1) {
                     ad[non].push(
                        GN);
                  }
                  else {
                     ad.push([
                                                                        NN
                        ]);
                     ad[ad.length -
                           1]
                        .push(GN);
                  }
               }
               , cadreGeometry: function (
                  II, L, T, W, H
                  ) {
                  if (!L || !T ||
                     !W || !H) {
                     L = 1;
                     T = 1;
                     W = 100;
                     H = 100;
                  }
                  var cadre =
                     `{
"type":"Collection",
"name":"XML_doss",
"crs":{"type":"name","utilisation":{"name": "CritCanvas"}},
"item":[
{"type":"Feature","utilisation":{"id":"` + II +
                     `","route":"null","couleur":"red","utiliser":"","contour":null,"Ordre":"-3"},"geometry":{"type":"Polygon","coordinates":[[[` +
                     L
                  .toString() +
                     `,` + T
                     .toString() +
                     `],[` + (L +
                        W)
                     .toString() +
                     `,` + T
                     .toString() +
                     `],[` + (L +
                        W)
                     .toString() +
                     `,` + (T + H)
                     .toString() +
                     `],[` + L
                     .toString() +
                     `,` + (T + H)
                     .toString() +
                     `],[` + L
                     .toString() +
                     `,` + T
                     .toString() +
                     `]]]}}` +
                     `]}`;
                  return {
                     GeoString: function () {
                        return cadre;
                     }
                     , GeoJson: function () {
                        return JSON
                           .parse(
                              cadre
                              );
                     }
                     , plusItem: function (
                        II, L,
                        T, W, H
                        ) {
                        var Yu =
                           JSON
                           .parse(
                              cadre
                              );
                        var Uy =
                           `{"type":"Feature","utilisation":{"id":"` +
                           II +
                           `","route":"null","couleur":"blue","utiliser":"","contour":null,"Ordre":"-1"},"geometry":{"type":"Polygon","coordinates":[[[` +
                           L
                           .toString() +
                           `,` +
                           T
                           .toString() +
                           `],[` +
                           (L +
                              W
                              )
                           .toString() +
                           `,` +
                           T
                           .toString() +
                           `],[` +
                           (L +
                              W
                              )
                           .toString() +
                           `,` +
                           (T +
                              H
                              )
                           .toString() +
                           `],[` +
                           L
                           .toString() +
                           `,` +
                           (T +
                              H
                              )
                           .toString() +
                           `],[` +
                           L
                           .toString() +
                           `,` +
                           T
                           .toString() +
                           `]]]}}`;
                        Yu.item
                           .push(
                              JSON
                              .parse(
                                 Uy
                                 )
                              );
                        cadre =
                           JSON
                           .stringify(
                              Yu
                              );
                     }
                     , changeCouleur: function (
                        ssT,
                        coul) {
                        var cool =
                           JSON
                           .parse(
                              cadre
                              );
                        for (
                           var sT =
                              0; sT <
                           cool
                           .item
                           .length; sT++
                           ) {
                           if (
                              cool
                              .item[
                                 sT
                                 ]
                              .utilisation
                              .id ==
                              ssT
                              ) {
                              cool
                                 .item[
                                    sT
                                    ]
                                 .utilisation
                                 .couleur =
                                 coul;
                           }
                        }
                        cadre =
                           JSON
                           .stringify(
                              cool
                              );
                     }
                     , utiliserHTML: function (
                        ssT,
                        coul) {
                        var cool =
                           JSON
                           .parse(
                              cadre
                              );
                        for (
                           var sT =
                              0; sT <
                           cool
                           .item
                           .length; sT++
                           ) {
                           if (
                              cool
                              .item[
                                 sT
                                 ]
                              .utilisation
                              .id ==
                              ssT
                              ) {
                              cool
                                 .item[
                                    sT
                                    ]
                                 .utilisation
                                 .utiliser =
                                 coul
                                 .replace(
                                    /\"/g,
                                    "`"
                                    );
                           }
                        }
                        cadre =
                           JSON
                           .stringify(
                              cool
                              );
                     }
                     , definirClique: function (
                        ssT,
                        coul) {
                        var cool =
                           JSON
                           .parse(
                              cadre
                              );
                        for (
                           var sT =
                              0; sT <
                           cool
                           .item
                           .length; sT++
                           ) {
                           if (
                              cool
                              .item[
                                 sT
                                 ]
                              .utilisation
                              .id ==
                              ssT
                              ) {
                              cool
                                 .item[
                                    sT
                                    ]
                                 .utilisation
                                 .route =
                                 coul;
                           }
                        }
                        cadre =
                           JSON
                           .stringify(
                              cool
                              );
                     }
                     , changeOrdre: function (
                        ssT,
                        coul) {
                        var cool =
                           JSON
                           .parse(
                              cadre
                              );
                        for (
                           var sT =
                              0; sT <
                           cool
                           .item
                           .length; sT++
                           ) {
                           if (
                              cool
                              .item[
                                 sT
                                 ]
                              .utilisation
                              .id ==
                              ssT
                              ) {
                              cool
                                 .item[
                                    sT
                                    ]
                                 .utilisation
                                 .Ordre =
                                 coul;
                           }
                        }
                        cadre =
                           JSON
                           .stringify(
                              cool
                              );
                     }
                     , definirContour: function (
                        ssT,
                        coul) {
                        var cool =
                           JSON
                           .parse(
                              cadre
                              );
                        for (
                           var sT =
                              0; sT <
                           cool
                           .item
                           .length; sT++
                           ) {
                           if (
                              cool
                              .item[
                                 sT
                                 ]
                              .utilisation
                              .id ==
                              ssT
                              ) {
                              cool
                                 .item[
                                    sT
                                    ]
                                 .utilisation
                                 .contour =
                                 coul;
                           }
                        }
                        cadre =
                           JSON
                           .stringify(
                              cool
                              );
                     }
                  }
               }
            }
         }
         // ---------------------------------------------------- //
         // ------------------ CORE GRAPH ---------------------- //
         // ---------------------------------------------------- //
         var Force = 1;
         var Endurance = 1;
         var Chance = 1;
         var Agilitee = 1;
         var Portee = 3;
         var critJS;
         var addition;
         var Qinv = [];
         for (var graph11 = 1; graph11 <
            8 + 1; graph11++) {
            Qinv.push([
                                        "white*VIDE%0"
               ]);
            for (var graph22 =
               2; graph22 < 8 +
               1; graph22++) {
               Qinv[graph11 - 1].push(
                  "white*VIDE%0");
            }
         }
         
         function graphismeLoad() {
            ad = [];
            var ok2 = prog("inventaire",
               0.4, 0.4, 0.6, 0.6);
            var ajoue2 = ok2
               .cadreGeometry("Cadre2");
            ajoue2.plusItem("GameCarac",
               60, 50, 40, 20);
            ajoue2.definirClique(
               "GameCarac",
               `this*function_clickItemCaracteristique(this)_Header*inventaire`
               );
            ajoue2.changeCouleur(
               "GameCarac",
               "rgba(150,150,150,1)");
            ajoue2.utiliserHTML(
               "GameCarac",
               "<p style='font-size:30px; position:absolute; left:4%; top:-40%;'>Caracteristique</p>"
               );
            ajoue2.changeOrdre(
               "GameCarac", "2");
            ajoue2.plusItem("GameGraph",
               60, 80, 40, 20);
            ajoue2.definirClique(
               "GameGraph",
               `this*function_clickItemInventaire(this)_Header*inventaire`
               );
            ajoue2.changeCouleur(
               "GameGraph",
               "rgba(150,150,150,1)");
            ajoue2.changeCouleur(
               "Cadre2",
               "rgba(1,1,1,0)");
            ajoue2.utiliserHTML(
               "GameGraph",
               "<p style='font-size:30px; position:absolute; left:4%; top:-40%;'>Inventaire</p>"
               );
            ajoue2.changeOrdre(
               "GameGraph", "2");
            ok2.ajouterGeometry(
               "inventaire", ajoue2
               .GeoString());
            var charge2 = ok2.Activer();
            if (!document
               .getElementById(
                  "DIVHeader")) {
               charge2.ChargerPage(
                  "Header",
                  "inventaire", true,
                  true);
            }
            else {
               charge.ChargerPage(
                  "DIVHeader",
                  "inventaire", true,
                  false);
            }
            document.getElementById(
                  "Header")
               .style.zIndex = "55";
            return {
               loadCarac: function () {
                  var sizeMap = 8;
                  ad = [];
                  critJS = prog(
                     "graphGame",
                     0.6, 1.4, -
                     0.5, -0.4);
                  addition = critJS
                     .cadreGeometry(
                        "Font", 0.9,
                        0.8,
                        sizeMap + 1,
                        sizeMap + 0.4
                        );
                  addition
                     .changeCouleur(
                        "Font",
                        "rgb(125,125,125)"
                        );
                  addition
                     .definirContour(
                        "Font", "arc"
                        );
                  addition
                     .definirClique(
                        "Font",
                        `this*function_clickItemInventaire(this)_DIVGameGraph*Font`
                        );
                  for (var graph =
                     1; graph <
                     sizeMap +
                     1; graph++) {
                     //graph1 1,1 0.95 0.95 graph2 2 0.95 = 0.05 entre 1 et 2
                     var loadText2 =
                        "0";
                     if (graph ==
                        1) {
                        loadText2 =
                           "Force";
                     }
                     else if (
                        graph == 2) {
                        loadText2 =
                           "Endurance";
                     }
                     else if (
                        graph == 3) {
                        loadText2 =
                           "Chance";
                     }
                     else if (
                        graph == 4) {
                        loadText2 =
                           "Agilitee";
                     }
                     else if (
                        graph == 5) {
                        loadText2 =
                           "Portee";
                     }
                     else if (
                        graph == 6
                        ) {}
                     else if (
                        graph == 7
                        ) {}
                     else if (
                        graph == 8
                        ) {}
                     addition
                        .plusItem(
                           `Cara+${"caract" +  (graph).toString()}`,
                           1, Math
                           .abs(
                              graph),
                           3, 0.9);
                     addition
                        .plusItem(
                           `CaraAdd+${"caract" +  (graph).toString()}`,
                           4.5, Math
                           .abs(
                              graph),
                           3.5, 0.9);
                     addition
                        .definirContour(
                           `Cara+${"caract" +  (graph).toString()}`,
                           "mouse*DIVCadre2_rgba(25,25,25,0.5)_graphGame"
                           );
                     addition
                        .changeCouleur(
                           `Cara+${"caract" +  (graph).toString()}`,
                           "blue");
                     var loadText =
                        "0";
                     if (graph ==
                        1) {
                        loadText =
                           Force
                           .toString();
                     }
                     else if (
                        graph == 2) {
                        loadText =
                           Endurance
                           .toString();
                     }
                     else if (
                        graph == 3) {
                        loadText =
                           Chance
                           .toString();
                     }
                     else if (
                        graph == 4) {
                        loadText =
                           Agilitee
                           .toString();
                     }
                     else if (
                        graph == 5) {
                        loadText =
                           Portee
                           .toString();
                     }
                     else if (
                        graph == 6
                        ) {}
                     else if (
                        graph == 7
                        ) {}
                     else if (
                        graph == 8
                        ) {}
                     var clii =
                        `<button onclick='clickCarac(this, "herbe%1", "` +
                        loadText2 +
                        `", true)'>Herbe +1</button>`;
                     clii +=
                        `<button onclick='clickCarac(this, "Terre%2", "` +
                        loadText2 +
                        `", true)'>Terre +2</button>`;
                     clii +=
                        `<button onclick='clickCarac(this, "Argile%3", "` +
                        loadText2 +
                        `", true)'>Argile +3</button>`;
                     //var clii = "";
                     addition
                        .utiliserHTML(
                           `Cara+${"caract" +  (graph).toString()}`,
                           "<p style='background-color:white'>" +
                           loadText2 +
                           "</p>");
                     addition
                        .utiliserHTML(
                           `CaraAdd+${"caract" +  (graph).toString()}`,
                           "<p style='background-color:white'>" +
                           loadText +
                           "</p>" +
                           clii);
                     addition
                        .changeOrdre(
                           `Cara+${"caract" +  (graph).toString()}`,
                           "3");
                  }
                  critJS
                     .ajouterGeometry(
                        "graphGame",
                        addition
                        .GeoString()
                        );
                  var charge = critJS
                     .Activer();
                  //critJS.autoZoom(true);
                  //charge.autoRedimention(false, "GameGraph");
                  if (!document
                     .getElementById(
                        "DIVCadre2")
                     ) {
                     charge
                        .ChargerPage(
                           "DIVCadre2",
                           "graphGame",
                           true, true
                           );
                  }
                  else {
                     charge
                        .ChargerPage(
                           "DIVCadre2",
                           "graphGame",
                           true,
                           false);
                  }
                  document
                     .getElementById(
                        "DIVGameGraph"
                        )
                     .style.zIndex =
                     "58";
               }
               , load: function () {
                  var sizeMap = 8;
                  ad = [];
                  critJS = prog(
                     "graphGame",
                     0.6, 1, -0.5,
                     -0.4);
                  addition = critJS
                     .cadreGeometry(
                        "Font", 0.9,
                        0.8,
                        sizeMap + 1,
                        sizeMap + 0.4
                        );
                  addition
                     .changeCouleur(
                        "Font",
                        "rgb(125,125,125)"
                        );
                  addition
                     .definirContour(
                        "Font", "arc"
                        );
                  addition
                     .definirClique(
                        "Font",
                        `this*function_clickItemInventaire(this)_DIVGameGraph*Font`
                        );
                  for (var graph =
                     1; graph <
                     sizeMap +
                     1; graph++) {
                     for (var
                           graph2 =
                           1; graph2 <
                        sizeMap +
                        1; graph2++
                        ) {
                        //graph1 1,1 0.95 0.95 graph2 2 0.95 = 0.05 entre 1 et 2
                        addition
                           .plusItem(
                              `Case+${( graph2).toString() +  (graph).toString()}`,
                              Math
                              .abs(
                                 graph
                                 ),
                              Math
                              .abs(
                                 graph2
                                 ),
                              0.9,
                              0.9);
                        addition
                           .definirClique(
                              `Case+${( graph2).toString() +  (graph).toString()}`,
                              `this*function_clickItem(this, ${( graph2).toString() +  (graph).toString()}, ${graph}, ${graph2})_GameGraph*graphGame`
                              );
                        addition
                           .definirContour(
                              `Case+${( graph2).toString() +  (graph).toString()}`,
                              "mouse*DIVCadre2_rgba(25,25,25,0.5)_graphGame"
                              );
                        addition
                           .changeCouleur(
                              `Case+${( graph2).toString() +  (graph).toString()}`,
                              Qinv[
                                 graph -
                                 1]
                                                                        [
                                 graph2 -
                                                                                1
                                                                                ]
                              .split(
                                 "*"
                                 )[0]
                              );
                        if (Qinv[
                              graph -
                              1]
                                                                        [
                              graph2 -
                                                                                1
                                                                                ]
                           .split(
                              "*")[1]
                           .split(
                              "%")[0]
                           .split(
                              "++")
                           .length ==
                           2) {
                           var loadText =
                              Qinv[
                                 graph -
                                 1]
                                                                                [
                                 graph2 -
                                                                                        1
                                                                                        ]
                              .split(
                                 "*"
                                 )[1]
                              .split(
                                 "%"
                                 )[0]
                              .split(
                                 "++"
                                 )[
                              1];
                        }
                        else {
                           var loadText =
                              Qinv[
                                 graph -
                                 1]
                                                                                [
                                 graph2 -
                                                                                        1
                                                                                        ]
                              .split(
                                 "*"
                                 )[1]
                              .split(
                                 "%"
                                 )[
                              0];
                        }
                        addition
                           .utiliserHTML(
                              `Case+${( graph2).toString() +  (graph).toString()}`,
                              "<p style='background-color:white'>" +
                              loadText +
                              "</p>"
                              );
                        addition
                           .changeOrdre(
                              `Case+${( graph2).toString() +  (graph).toString()}`,
                              "3");
                     }
                  }
                  critJS
                     .ajouterGeometry(
                        "graphGame",
                        addition
                        .GeoString()
                        );
                  var charge = critJS
                     .Activer();
                  //critJS.autoZoom(true);
                  //charge.autoRedimention(false, "GameGraph");
                  if (!document
                     .getElementById(
                        "DIVCadre2")
                     ) {
                     charge
                        .ChargerPage(
                           "DIVCadre2",
                           "graphGame",
                           true, true
                           );
                  }
                  else {
                     charge
                        .ChargerPage(
                           "DIVCadre2",
                           "graphGame",
                           true,
                           false);
                  }
                  document
                     .getElementById(
                        "DIVGameGraph"
                        )
                     .style.zIndex =
                     "58";
               }
            }
         }
         
         function clickItemInventaire(
            element) {
            if (!document
               .getElementById("Font")
               ) {
               inventaire.load();
            }
            else {
               inventaire =
                  graphismeLoad();
            }
         }
         
         function clickItemCaracteristique(
            element) {
            if (!document
               .getElementById("Font")
               ) {
               inventaire.loadCarac();
            }
            else {
               inventaire =
                  graphismeLoad();
            }
         }
         
         function clickCarac(element,
            graph2, value, graph3) {
            var herbe = 1;
            console.log(value);
            for (var zr = 0; zr < Qinv
               .length; zr++) {
               for (var zr2 = 0; zr2 <
                  Qinv[zr].length; zr2++
                  ) {
                  if (Qinv[zr]
                                                        [
                                                                zr2
                        ].split("*")[1]
                     .split("%")[0] ==
                     graph2.split("%")[
                        0]) {
                     if (Number(Qinv[zr]
                                                                        [
                                                                                zr2
                              ].split(
                              "%")[1]
                           ) >= 10) {
                        Qinv[zr][
                                                                                zr2
                              ] = Qinv[
                              zr]
                                                                        [
                                                                                zr2
                              ].split(
                              "%")[0] +
                           "%" + (
                              Number(
                                 Qinv[
                                    zr][
                                                                                                zr2
                                    ]
                                 .split(
                                    "%"
                                    )[1]
                                 ) - 10)
                           .toString();
                        herbe = 2;
                        if (value ==
                           "Force") {
                           Force += Math
                              .round(
                                 Number(
                                    graph2
                                    .split(
                                       "%"
                                       )[
                                       1
                                       ] /
                                    (Math
                                       .random() *
                                       30
                                       ) +
                                    0.1)
                                 ) +
                              Math
                              .round(
                                 Number(
                                    Qinv[
                                       zr
                                       ]
                                                                                                [
                                                                                                        zr2
                                       ]
                                    .split(
                                       "%"
                                       )[
                                       1
                                       ]
                                    ) /
                                 10);
                        }
                        else if (
                           value ==
                           "Endurance"
                           ) {
                           Endurance +=
                              Math
                              .round(
                                 Number(
                                    graph2
                                    .split(
                                       "%"
                                       )[
                                       1
                                       ] /
                                    (Math
                                       .random() *
                                       40
                                       ) +
                                    0.1)
                                 ) +
                              Math
                              .round(
                                 Number(
                                    Qinv[
                                       zr
                                       ]
                                                                                                [
                                                                                                        zr2
                                       ]
                                    .split(
                                       "%"
                                       )[
                                       1
                                       ]
                                    ) /
                                 30);
                        }
                        else if (
                           value ==
                           "Chance") {
                           Chance +=
                              Math
                              .round(
                                 Number(
                                    graph2
                                    .split(
                                       "%"
                                       )[
                                       1
                                       ] /
                                    (Math
                                       .random() *
                                       25
                                       ) +
                                    0.1)
                                 ) +
                              Math
                              .round(
                                 Number(
                                    Qinv[
                                       zr
                                       ]
                                                                                                [
                                                                                                        zr2
                                       ]
                                    .split(
                                       "%"
                                       )[
                                       1
                                       ]
                                    ) /
                                 20);
                        }
                        else if (
                           value ==
                           "Agilitee" &&
                           Agilitee < 4
                           ) {
                           Agilitee +=
                              Math
                              .round(
                                 Number(
                                    graph2
                                    .split(
                                       "%"
                                       )[
                                       1
                                       ] /
                                    (Math
                                       .random() *
                                       130
                                       ) +
                                    0.1)
                                 ) +
                              Math
                              .round(
                                 Number(
                                    Qinv[
                                       zr
                                       ]
                                                                                                [
                                                                                                        zr2
                                       ]
                                    .split(
                                       "%"
                                       )[
                                       1
                                       ]
                                    ) /
                                 100);
                        }
                        else if (
                           value ==
                           "Portee") {
                           Portee +=
                              Math
                              .round(
                                 Number(
                                    graph2
                                    .split(
                                       "%"
                                       )[
                                       1
                                       ] /
                                    (Math
                                       .random() *
                                       60
                                       ) +
                                    0.1)
                                 ) +
                              Math
                              .round(
                                 Number(
                                    Qinv[
                                       zr
                                       ]
                                                                                                [
                                                                                                        zr2
                                       ]
                                    .split(
                                       "%"
                                       )[
                                       1
                                       ]
                                    ) /
                                 10);
                        }
                        if (Agilitee >
                           4) {
                           Agilitee = 4
                        }
                        if (Chance >
                           40) {
                           Chance = 25
                        }
                        if (Endurance >
                           150) {
                           Endurance =
                              140
                        }
                        if (Force >
                           Endurance) {
                           Force =
                              Endurance
                        }
                        if (Portee >
                           90) {
                           Portee = 90
                        }
                        break;
                     }
                     else {
                        console.log(
                           "pas assez drop"
                           );
                        break;
                     }
                  }
               }
               if (herbe == 2) {
                  break;
               }
            }
            if (herbe == 1) {
               console.log("pas drop");
            }
         }
         
         function clickItem(element,
            graph, graph2, graph3) {
            if (!document
               .getElementById(
                  "FontLitem" + graph)
               ) {
               var Litem = prog(
                  "Litem" + graph, 1,
                  1);
               var Laddition = Litem
                  .cadreGeometry(
                     "FontLitem" +
                     graph, 100, 100,
                     0.1, 0.1);
               Laddition.changeCouleur(
                  "FontLitem" +
                  graph, "white");
               Laddition.plusItem(
                  "LITE" + graph,
                  100, 100, 0.1, 0.1);
               Laddition.changeCouleur(
                  "LITE" + graph,
                  "black");
               Laddition.definirClique(
                  "LITE" + graph,
                  `this*function_clickItem(this, ${( graph3).toString() +  (graph2).toString()}, ${graph2}, ${graph3})_GameGraph*graphGame`
                  );
               Laddition.utiliserHTML(
                  "LITE" + graph,
                  `<p style='font-size:20px; position:absolute; left:4%; top:-40%; color:white;'>QTE : ${Qinv[graph2-1][graph3-1].split("%")[1]} </p>`
                  ); //" is already use for create geojson final
               Laddition.changeOrdre(
                  `LITE` + graph,
                  "63");
               Litem.ajouterGeometry(
                  "Litem" + graph,
                  Laddition
                  .GeoString());
               var chargeL = Litem
                  .Activer();
               if (!document
                  .getElementById(
                     "DIVCase+" + graph)
                  ) {}
               else {
                  chargeL.ChargerPage(
                     "DIVCase+" +
                     graph, "Litem" +
                     graph, false,
                     false);
               }
            }
            else {
               if (!document
                  .getElementById(
                     "DIVCase+" + graph)
                  ) {}
               else if (Qinv[graph2 - 1]
                                                [
                     graph3 -
                                                        1
                                                        ]
                  .split("++")
                  .length == 2) {
                  Force = Qinv[graph2 -
                        1]
                                                        [
                        graph3 -
                                                                1
                                                                ]
                     .split("+")[0]
                     .split("*")[1];
                  Endurance = Qinv[
                        graph2 - 1]
                                                        [
                        graph3 -
                                                                1
                                                                ]
                     .split("+")[1];
                  Chance = Qinv[graph2 -
                        1]
                                                        [
                        graph3 -
                                                                1
                                                                ]
                     .split("+")[2];
                  Agilitee = Qinv[
                        graph2 - 1]
                                                        [
                        graph3 -
                                                                1
                                                                ]
                     .split("+")[3];
                  Portee = Qinv[graph2 -
                        1]
                                                        [
                        graph3 -
                                                                1
                                                                ]
                     .split("+")[4];
                  document
                     .getElementById(
                        "DIVCase+" +
                        graph)
                     .innerHTML =
                     "équiper";
               }
            }
            var stringADD = `${graph}`;
            element.style.fontSize =
               "16px";
            element.style.color =
               "white";
            element.style.display =
               "flex";
            element.style
               .justifyContent =
               "center";
            element.style.alignItems =
               "center";
            element.style.border =
               "1pt solid green";
            element.onselectstart =
               "return false;";
            element.innerHTML =
               stringADD;
         }
         var inventaire;
         
      </script>
   </head>
   
   <body onload="C()">
      <script>
         var scalex
            , scaley
            , w, z
            , stage, Rotations = "r";
         
         function C() {
            inventaire =
         graphismeLoad();
            PIXI.utils.skipHello();
            var e = new PIXI
               .Application({
                  width: 1960
                  , height: 1640
                  , backgroundColor: 0
                  , antialias: !0
                  , autoDensity: !0
                  , resolution: 2
                  , resizeTo: window
               });
            document.body.appendChild(e
                  .view), stage = e
               .stage;
            document.innerWidth
               , document.innerHeight;
            e.stage.interactive = !0;
            var t = .95 * window
               .innerWidth
               , n = .95 * window
               .innerHeight;
            e.screen.x = 0
               , e.screen.y = 0
               , e.screen.width = t
               , e.screen.height = n
               , stage.scale.x = .7,
               stage.scale.y = .7;
            let i = new PIXI.Container;
            i.x = 1, i.y = 1
               , i.name = "joueur",
               stage.addChild(i)
               , e.ticker.add(
                  (e => {
                     "r" != (
                        Rotations = -
                        360 * Math
                        .atan2(window
                           .innerHeight /
                           2 -
                           clientY,
                           window
                           .innerWidth /
                           2 -
                           clientX) /
                        (2 * Math
                        .PI) - 90) &&
                     (stage.x += -3 *
                        Math.sin(2 *
                           Math.PI *
                           (Rotations /
                              360)),
                        stage.y += -
                        3 * Math.cos(
                           2 * Math
                           .PI * (
                              Rotations /
                              360)),
                        console.log(-
                           3 * Math
                           .sin(2 *
                              Math
                              .PI * (
                                 Rotations /
                                 360)
                              )))
                     , i.x = stage.x
                        , i.y = stage
                        .y
                  }));
            for (var r = 1; r < 80; r++)
               for (var o = 1; o <
                  80; o++)
                  renderIsometricTile(
                     stage, 0, 0, 48,
                     30, 5885328,
                     3648368, 2455376, r
                     .toString() +
                     "entier" + o
                     .toString(), r, o)
         }
         
         function getSell(e, t, n, i) {
            var r = [];
            if ("contour" == i) {
               for (var o = -n; o <=
                  n; o += 2 * n)
                  for (var a = 1 -
                     n; a <= n - 1; a++)
                     stage
                     .getChildByName(
                        (e + o)
                        .toString() +
                        "entier" + (t +
                           a)
                        .toString()) &&
                     r.push(stage
                        .getChildByName(
                           (e + o)
                           .toString() +
                           "entier" + (
                              t + a)
                           .toString())
                        );
               for (o = 1 - n; o <= n -
                  1; o++)
                  for (a = -n; a <=
                     n; a += 2 * n)
                     stage
                     .getChildByName(
                        (e + o)
                        .toString() +
                        "entier" + (t +
                           a)
                        .toString()) &&
                     r.push(stage
                        .getChildByName(
                           (e + o)
                           .toString() +
                           "entier" + (
                              t + a)
                           .toString()))
            }
            else if ("entier" == i)
               for (o = -n; o <= n; o++)
                  for (a = -n; a <=
                     n; a++) stage
                     .getChildByName(
                        (e + o)
                        .toString() +
                        "entier" + (t +
                           a)
                        .toString()) &&
                     r.push(stage
                        .getChildByName(
                           (e + o)
                           .toString() +
                           "entier" + (
                              t + a)
                           .toString())
                        );
            return r
         }
         
         function renderIsometricTile(e,
            t, n, i, r, o, a, s, l, d, g
            ) {
            TILE_WIDTH = d
               , TILE_WIDTH_HALF = 42
               , TILE_HEIGHT = g,
               TILE_HEIGHT_HALF = 31
               , t = g *
               TILE_WIDTH_HALF - d *
               TILE_WIDTH_HALF
               , n = g *
               TILE_HEIGHT_HALF + d *
               TILE_HEIGHT_HALF;
            let c = new PIXI.Container;
            c.name = l
               , e.addChild(c);
            var h = new PIXI.Graphics;
            h.beginFill(o)
               , h.drawRect(0, 0, i, i)
               , h.endFill()
               , h.setTransform(t, n +
                  .5 * i, 1, 1, 0, 1.1,
                  -.5, 0, 0);
            var I = new PIXI.Graphics;
            I.beginFill(a)
               , I.drawRect(0, 0, r, i)
               , I.endFill()
               , I.setTransform(t, n +
                  .5 * i, 1, 1, 0, 1.1,
                  1.57, 0, 0);
            var u = new PIXI.Graphics;
            u.beginFill(s)
               , u.drawRect(0, 0, i, r)
               , u.endFill()
               , u.setTransform(t, n +
                  .5 * i, 1, 1, 0, -0, -
                  .5, -(i + .015 * i), -
                  (i - .06 * i))
               , h.interactive = !0
               , h.cursor = "pointer"
               , h.on("click"
                  , (function (e) {
                     h.tint = "blue";
                     var herbe = 1;
                     var itemvar =
                        "Terre%2%build.png*Herbe%3%vita.png";
                     var itemL = Math
                        .round(Math
                           .random() *
                           0.65);
                     for (var zr =
                        0; zr < Qinv
                        .length; zr++
                        ) {
                        for (var
                              zr2 =
                              0; zr2 <
                           Qinv[zr]
                           .length; zr2++
                           ) {
                           if (Qinv[
                                 zr]
                                                                                [
                                                                                        zr2
                                 ]
                              .split(
                                 "*"
                                 )[1]
                              .split(
                                 "%"
                                 )[
                              0] ==
                              itemvar
                              .split(
                                 "*"
                                 )[
                                 itemL
                                 ]
                              .split(
                                 "%"
                                 )[0]
                              ) {
                              Qinv[
                                    zr]
                                 [
                                                                                                zr2
                                    ] =
                                 Qinv[
                                    zr
                                    ]
                                                                                        [
                                                                                                zr2
                                    ]
                                 .split(
                                    "%"
                                    )[
                                    0
                                    ] +
                                 "%" +
                                 (Number(
                                       Qinv[
                                          zr
                                          ]
                                       [
                                                                                                                zr2
                                          ]
                                       .split(
                                          "%"
                                          )[
                                          1
                                          ]
                                       ) +
                                    Math
                                    .round(
                                       Number(
                                          itemvar
                                          .split(
                                             "*"
                                             )[
                                             itemL
                                             ]
                                          .split(
                                             "%"
                                             )[
                                             1
                                             ]
                                          ) *
                                       Math
                                       .random() +
                                       1
                                       )
                                    )
                                 .toString();
                              herbe =
                                 2;
                              break;
                           }
                        }
                        if (herbe ==
                           2) {
                           break;
                        }
                     }
                     if (herbe ==
                        1) {
                        var caillou =
                           1;
                        for (var zr =
                              0; zr <
                           Qinv
                           .length; zr++
                           ) {
                           for (var
                                 zr2 =
                                 0; zr2 <
                              Qinv[
                                 zr]
                              .length; zr2++
                              ) {
                              if (
                                 Qinv[
                                    zr
                                    ]
                                                                                        [
                                                                                                zr2
                                    ]
                                 .split(
                                    "*"
                                    )[
                                    1
                                    ]
                                 .split(
                                    "%"
                                    )[
                                    0
                                    ] ==
                                 "VIDE"
                                 ) {
                                 Qinv
                                    [
                                       zr]
                                    [
                                                                                                        zr2
                                       ] =
                                    "LoadImage~./" +
                                    itemvar
                                    .split(
                                       "*"
                                       )[
                                       itemL
                                       ]
                                    .split(
                                       "%"
                                       )[
                                       2
                                       ] +
                                    "*" +
                                    itemvar
                                    .split(
                                       "*"
                                       )[
                                       itemL
                                       ]
                                    .split(
                                       "%"
                                       )[
                                       0
                                       ] +
                                    "%" +
                                    (Number(
                                          Qinv[
                                             zr
                                             ]
                                          [
                                                                                                                        zr2
                                             ]
                                          .split(
                                             "%"
                                             )[
                                             1
                                             ]
                                          ) +
                                       Math
                                       .round(
                                          Number(
                                             itemvar
                                             .split(
                                                "*"
                                                )[
                                                itemL
                                                ]
                                             .split(
                                                "%"
                                                )[
                                                1
                                                ]
                                             ) *
                                          Math
                                          .random() +
                                          1
                                          )
                                       )
                                    .toString();
                                 caillou
                                    =
                                    2;
                                 break;
                              }
                           }
                           if (
                              caillou ==
                              2) {
                              break;
                           }
                        }
                     }
                     itemvar =
                        "10+20+10+1+3++épée%0%vita.png*3+5+10+2+15++arc%0%vita.png*30+5+20+1+5++hache%0%vita.png*15+15+50+1+10++pioche%0%build.png*30+50+1+3+15++Vulbis%0%build.png";
                     itemL = Math
                        .round(Math
                           .random() *
                           0.85 + (
                              Chance /
                              200));
                     if (itemL ==
                        1) {
                        itemL += Math
                           .round(
                              Math
                              .random() *
                              0.85 +
                              (Chance /
                                 200)
                              );
                     }
                     if (itemL ==
                        2) {
                        itemL += Math
                           .round(
                              Math
                              .random() *
                              0.75 +
                              (Chance /
                                 200)
                              );
                     }
                     if (itemL ==
                        3) {
                        itemL += Math
                           .round(
                              Math
                              .random() *
                              0.65 +
                              (Chance /
                                 200)
                              );
                     }
                     var herbe = 1;
                     for (var zr =
                        0; zr < Qinv
                        .length; zr++
                        ) {
                        for (var
                              zr2 =
                              0; zr2 <
                           Qinv[zr]
                           .length; zr2++
                           ) {
                           if (Qinv[
                                 zr]
                                                                                [
                                                                                        zr2
                                 ]
                              .split(
                                 "*"
                                 )[1]
                              .split(
                                 "%"
                                 )[
                              0] ==
                              itemvar
                              .split(
                                 "*"
                                 )[
                                 itemL
                                 ]
                              .split(
                                 "%"
                                 )[0]
                              ) {
                              Qinv[
                                    zr]
                                 [
                                                                                                zr2
                                    ] =
                                 Qinv[
                                    zr
                                    ]
                                                                                        [
                                                                                                zr2
                                    ]
                                 .split(
                                    "%"
                                    )[
                                    0
                                    ] +
                                 "%" +
                                 (Number(
                                       Qinv[
                                          zr
                                          ]
                                       [
                                                                                                                zr2
                                          ]
                                       .split(
                                          "%"
                                          )[
                                          1
                                          ]
                                       ) +
                                    Math
                                    .round(
                                       Number(
                                          itemvar
                                          .split(
                                             "*"
                                             )[
                                             itemL
                                             ]
                                          .split(
                                             "%"
                                             )[
                                             1
                                             ]
                                          ) *
                                       Math
                                       .random() +
                                       1
                                       )
                                    )
                                 .toString();
                              herbe =
                                 2;
                              break;
                           }
                        }
                        if (herbe ==
                           2) {
                           break;
                        }
                     }
                     if (herbe ==
                        1) {
                        var caillou =
                           1;
                        for (var zr =
                              0; zr <
                           Qinv
                           .length; zr++
                           ) {
                           for (var
                                 zr2 =
                                 0; zr2 <
                              Qinv[
                                 zr]
                              .length; zr2++
                              ) {
                              if (
                                 Qinv[
                                    zr
                                    ]
                                                                                        [
                                                                                                zr2
                                    ]
                                 .split(
                                    "*"
                                    )[
                                    1
                                    ]
                                 .split(
                                    "%"
                                    )[
                                    0
                                    ] ==
                                 "VIDE"
                                 ) {
                                 Qinv
                                    [
                                       zr]
                                    [
                                                                                                        zr2
                                       ] =
                                    "LoadImage~" +
                                    itemvar
                                    .split(
                                       "*"
                                       )[
                                       itemL
                                       ]
                                    .split(
                                       "%"
                                       )[
                                       2
                                       ] +
                                    "*" +
                                    itemvar
                                    .split(
                                       "*"
                                       )[
                                       itemL
                                       ]
                                    .split(
                                       "%"
                                       )[
                                       0
                                       ] +
                                    "%" +
                                    (Number(
                                          Qinv[
                                             zr
                                             ]
                                          [
                                                                                                                        zr2
                                             ]
                                          .split(
                                             "%"
                                             )[
                                             1
                                             ]
                                          ) +
                                       Math
                                       .round(
                                          Number(
                                             itemvar
                                             .split(
                                                "*"
                                                )[
                                                itemL
                                                ]
                                             .split(
                                                "%"
                                                )[
                                                1
                                                ]
                                             ) *
                                          Math
                                          .random() +
                                          1
                                          )
                                       )
                                    .toString();
                                 caillou
                                    =
                                    2;
                                 break;
                              }
                           }
                           if (
                              caillou ==
                              2) {
                              break;
                           }
                        }
                     }
                     console.log(e)
                        , w = .95 *
                        window
                        .innerWidth
                        , z = .95 *
                        window
                        .innerHeight
                  }))
               , h.on("mouseover"
                  , (function (e) {
                     for (var t =
                           getSell(d,
                              g, 9,
                              "entier"
                              )
                           , n =
                           0; n < t
                        .length; n++)
                        t[n].y += 4
                  }))
               , h.on("mouseout"
                  , (function () {
                     for (var e =
                           getSell(d,
                              g, 9,
                              "entier"
                              )
                           , t =
                           0; t < e
                        .length; t++)
                        e[t].y -= 4
                  }))
               , c.addChild(h)
               , c.addChild(I)
               , c.addChild(u)
         }
         
         function handleResize() {
            w = .95 * window.innerWidth
               , z = .95 * window
               .innerHeight, scalex =
               w / 960
               , scaley = z / 640
         }
         window.addEventListener(
            "resize", handleResize, {
               passive: !0
            });
         var clientX = 0
            , clientY = 0;
         window.addEventListener(
            "mousemove"
            , (function (e) {
               clientX = e
                  .clientX,
                  clientY = e
                  .clientY
            }), {
               passive: !0
            });
         
      </script>
      <canvas id="renderCanvas"
         style='z-index:50;'></canvas>
   </body>
   
</html>
